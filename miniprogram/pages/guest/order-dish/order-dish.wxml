<!--pages/guest/order-dish/order-dish.wxml-->
<view class="container">
  <view class="view-mode-tabs" wx:if="{{viewAll}}">
    <view class="tab-item {{viewMode === 'my' ? 'active' : ''}}" bindtap="switchViewMode" data-mode="my">
      æˆ‘çš„ç‚¹èœ
    </view>
    <view class="tab-item {{viewMode === 'all' ? 'active' : ''}}" bindtap="switchViewMode" data-mode="all">
      å…¨éƒ¨ç‚¹èœ
    </view>
  </view>

  <!-- æˆ‘çš„ç‚¹èœ -->
  <view class="order-content" wx:if="{{!viewAll || viewMode === 'my'}}">
    <view class="order-summary card">
      <text class="summary-label">å…±ç‚¹ {{myTotalQuantity}} ä»½</text>
      <text class="summary-price">Â¥{{myTotalPrice.toFixed(2)}}</text>
    </view>

    <view class="order-list">
      <view class="order-item card" wx:for="{{myOrderList}}" wx:key="id">
        <view class="order-info">
          <text class="dish-name">{{item.dishName}}</text>
          <text class="dish-price">Â¥{{item.price}}/ä»½</text>
        </view>
        <view class="order-controls">
          <view class="quantity-control">
            <text class="quantity-btn" bindtap="decreaseQuantity" data-id="{{item.id}}">-</text>
            <text class="quantity-number">{{item.quantity}}</text>
            <text class="quantity-btn" bindtap="increaseQuantity" data-id="{{item.id}}">+</text>
          </view>
          <text class="delete-btn" bindtap="deleteOrder" data-id="{{item.id}}">åˆ é™¤</text>
        </view>
        <text class="order-note" wx:if="{{item.note}}">å¤‡æ³¨ï¼š{{item.note}}</text>
      </view>
    </view>

    <view class="empty-state" wx:if="{{myOrderList.length === 0}}">
      <view class="empty-icon">ğŸ›’</view>
      <text class="empty-text">è¿˜æ²¡æœ‰ç‚¹èœï¼Œå¿«å»ç‚¹å§</text>
    </view>
  </view>

  <!-- å…¨éƒ¨ç‚¹èœ -->
  <view class="order-content" wx:if="{{viewAll && viewMode === 'all'}}">
    <view class="person-section" wx:for="{{ordersByPerson}}" wx:key="userId">
      <view class="person-header">
        <text class="person-name">{{item.userName || 'æœªçŸ¥ç”¨æˆ·'}}</text>
        <text class="person-count">{{item.totalQuantity}} ä»½</text>
      </view>
      <view class="order-list">
        <view class="order-item-small" wx:for="{{item.orders}}" wx:key="id" wx:for-item="order">
          <text class="dish-name">{{order.dishName}}</text>
          <text class="order-quantity">Ã—{{order.quantity}}</text>
        </view>
      </view>
    </view>

    <view class="empty-state" wx:if="{{ordersByPerson.length === 0}}">
      <view class="empty-icon">ğŸ“‹</view>
      <text class="empty-text">æš‚æ— ç‚¹èœè®°å½•</text>
    </view>
  </view>
</view>


