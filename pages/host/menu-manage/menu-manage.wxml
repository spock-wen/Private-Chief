<!--pages/host/menu-manage/menu-manage.wxml-->
<view class="container">
  <view class="header-actions">
    <button class="btn-secondary" bindtap="shareTable">åˆ†äº«é¥­æ¡Œ</button>
    <button class="btn-primary" bindtap="addDish">æ·»åŠ èœå“</button>
  </view>

  <view class="table-info card" wx:if="{{tableInfo}}">
    <text class="table-name">{{tableInfo.name}}</text>
    <text class="table-time" wx:if="{{tableInfo.diningDate}}">{{tableInfo.diningDate}} {{tableInfo.diningTime}}</text>
  </view>

  <view class="menu-tabs">
    <view class="tab-item {{currentCategory === 'all' ? 'active' : ''}}" bindtap="switchCategory" data-category="all">
      å…¨éƒ¨
    </view>
    <view class="tab-item {{currentCategory === item ? 'active' : ''}}" wx:for="{{categories}}" wx:key="*this" bindtap="switchCategory" data-category="{{item}}">
      {{item}}
    </view>
  </view>

  <view class="dish-list">
    <view class="dish-item card" wx:for="{{filteredDishes}}" wx:key="id">
      <image class="dish-image" src="{{item.image || '/images/default-dish.png'}}" mode="aspectFill"></image>
      <view class="dish-info">
        <view class="dish-header">
          <text class="dish-name">{{item.name}}</text>
          <view class="dish-status">
            <text class="status-tag recommended" wx:if="{{item.status === 'recommended'}}">æ¨è</text>
            <text class="status-tag soldout" wx:if="{{item.status === 'soldout'}}">å”®ç½„</text>
          </view>
        </view>
        <text class="dish-desc">{{item.description}}</text>
        <view class="dish-footer">
          <text class="dish-price">Â¥{{item.price}}</text>
          <view class="dish-actions">
            <text class="action-btn" bindtap="editDish" data-id="{{item.id}}">ç¼–è¾‘</text>
            <text class="action-btn delete" bindtap="deleteDish" data-id="{{item.id}}">åˆ é™¤</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <view class="empty-state" wx:if="{{filteredDishes.length === 0}}">
    <view class="empty-icon">ğŸ½ï¸</view>
    <text class="empty-text">æš‚æ— èœå“ï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ </text>
  </view>

  <view class="bottom-actions">
    <button class="btn-primary" bindtap="viewOrders">æŸ¥çœ‹ç‚¹èœæƒ…å†µ</button>
  </view>
</view>

<!-- æ·»åŠ /ç¼–è¾‘èœå“å¼¹çª— -->
<view class="modal {{showModal ? 'show' : ''}}" bindtap="closeModal">
  <view class="modal-content" catchtap="stopPropagation">
    <view class="modal-header">
      <text class="modal-title">{{editingDish ? 'ç¼–è¾‘èœå“' : 'æ·»åŠ èœå“'}}</text>
      <text class="modal-close" bindtap="closeModal">Ã—</text>
    </view>
    <view class="modal-body">
      <view class="input-group">
        <text class="input-label">èœå“åç§° *</text>
        <input class="input-field" placeholder="å¦‚ï¼šå®«ä¿é¸¡ä¸" value="{{dishForm.name}}" bindinput="onDishNameInput" />
      </view>
      <view class="input-group">
        <text class="input-label">åˆ†ç±»</text>
        <picker mode="selector" range="{{categories}}" value="{{categoryIndex}}" bindchange="onCategoryChange">
          <view class="picker-view">{{dishForm.category || 'é€‰æ‹©åˆ†ç±»'}}</view>
        </picker>
      </view>
      <view class="input-group">
        <text class="input-label">ä»·æ ¼ (å…ƒ)</text>
        <input class="input-field" type="digit" placeholder="0.00" value="{{dishForm.price}}" bindinput="onPriceInput" />
      </view>
      <view class="input-group">
        <text class="input-label">æè¿°</text>
        <textarea class="textarea-field" placeholder="èœå“æè¿°" value="{{dishForm.description}}" bindinput="onDescriptionInput" maxlength="200" />
      </view>
      <view class="input-group">
        <text class="input-label">èœå“çŠ¶æ€</text>
        <picker mode="selector" range="{{statusOptions}}" value="{{statusIndex}}" bindchange="onStatusChange">
          <view class="picker-view">{{dishForm.statusText || 'å¯é€‰æ‹©'}}</view>
        </picker>
      </view>
    </view>
    <view class="modal-footer">
      <button class="btn-secondary" bindtap="closeModal">å–æ¶ˆ</button>
      <button class="btn-primary" bindtap="saveDish">ä¿å­˜</button>
    </view>
  </view>
</view>


